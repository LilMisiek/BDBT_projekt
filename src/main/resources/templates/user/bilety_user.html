<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Zakup Biletu</title>
    <link th:rel="stylesheet" th:href="@{/webjars/bootstrap/4.0.0-2/css/bootstrap.min.css}">
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Cennik biletów i czas ważności
            const ticketData = {
                Jednorazowy: { price: 2.20, duration: "20 minut" },
                Godzinny: { price: 4.40, duration: "60 minut" },
                Całodniowy: { price: 12.00, duration: "24H" },
                Weekendowy: { price: 25.00, duration: "72H" }
            };

            // Funkcja obliczania ceny i czasu ważności
            function updateTicketDetails() {
                const type = document.getElementById("nazwa").value;
                const kind = document.getElementById("rodzaj").value;

                const ticketInfo = ticketData[type] || { price: 0, duration: "-" };
                let price = ticketInfo.price;
                if (kind === "ulgowy") {
                    price /= 2; // Bilety ulgowe są o połowę tańsze
                }

                // Aktualizacja ceny i czasu ważności
                document.getElementById("calculated-price").textContent = price.toFixed(2) + " zł";
                document.getElementById("czasWaznosci").value = ticketInfo.duration;
            }

            // Podłączenie eventów do pól formularza
            document.getElementById("nazwa").addEventListener("change", updateTicketDetails);
            document.getElementById("rodzaj").addEventListener("change", updateTicketDetails);

            // Ustawienie domyślnych wartości przy załadowaniu strony
            updateTicketDetails();
        });
    </script>
</head>
<body>
<div class="container mt-5">
    <h2>Zakup Biletu</h2>
    <form th:action="@{/user/bilety_user}" method="post">
        <div class="form-group">
            <label for="nazwa">Typ biletu</label>
            <select class="form-control" id="nazwa" name="nazwa" required>
                <option value="Jednorazowy">Jednorazowy</option>
                <option value="Godzinny">Godzinny</option>
                <option value="Całodniowy">Całodniowy</option>
                <option value="Weekendowy">Weekendowy</option>
            </select>
        </div>
        <div class="form-group">
            <label for="czasWaznosci">Czas ważności</label>
            <!-- Pole czas ważności jest wypełniane automatycznie -->
            <input type="text" class="form-control" id="czasWaznosci" name="czasWaznosci" readonly>
        </div>
        <div class="form-group">
            <label for="imie">Imię</label>
            <input type="text" class="form-control" id="imie" name="imie" required>
        </div>
        <div class="form-group">
            <label for="nazwisko">Nazwisko</label>
            <input type="text" class="form-control" id="nazwisko" name="nazwisko" required>
        </div>
        <div class="form-group">
            <label for="rodzaj">Rodzaj biletu</label>
            <select class="form-control" id="rodzaj" name="rodzaj" required>
                <option value="normalny">Normalny</option>
                <option value="ulgowy">Ulgowy</option>
            </select>
        </div>
        <div class="form-group">
            <label>Cena biletu:</label>
            <p id="calculated-price" style="font-size: 1.5rem; font-weight: bold;">0.00 zł</p>
        </div>
        <button type="submit" class="btn btn-primary">Kup bilet</button>
    </form>
</div>
</body>
</html>
